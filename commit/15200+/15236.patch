From ecefecca1ef83b18fe81d427de1d916dcade3222 Mon Sep 17 00:00:00 2001
From: GitHub Action <action@github.com>
Date: Sat, 17 Jan 2026 09:12:35 +0000
Subject: [PATCH] feat: Squash PR #15236 changes

---
 .github/workflows/pr-test.yml                 |  20 +
 python/pyproject.toml                         |   3 +-
 .../embeddings/1-gpu/fast_hunyuan_video.npy   | Bin 0 -> 9344 bytes
 .../embeddings/1-gpu/fastwan2_2_ti2v_5b.npy   | Bin 0 -> 9344 bytes
 .../embeddings/1-gpu/flux_2_image_t2i.npy     | Bin 0 -> 3200 bytes
 .../embeddings/1-gpu/flux_2_ti2i.npy          | Bin 0 -> 3200 bytes
 .../embeddings/1-gpu/flux_image_t2i.npy       | Bin 0 -> 3200 bytes
 .../1-gpu/flux_image_t2i_2_gpus.npy           | Bin 0 -> 3200 bytes
 .../1-gpu/qwen_image_edit_2509_ti2i.npy       | Bin 0 -> 3200 bytes
 .../embeddings/1-gpu/qwen_image_edit_ti2i.npy | Bin 0 -> 3200 bytes
 .../embeddings/1-gpu/qwen_image_t2i.npy       | Bin 0 -> 3200 bytes
 .../embeddings/1-gpu/wan2_1_t2v_1.3b.npy      | Bin 0 -> 9344 bytes
 .../1-gpu/wan2_1_t2v_1_3b_lora_1gpu.npy       | Bin 0 -> 9344 bytes
 .../embeddings/1-gpu/wan2_2_i2v_a14b_2gpu.npy | Bin 0 -> 9344 bytes
 .../embeddings/1-gpu/wan2_2_ti2v_5b.npy       | Bin 0 -> 9344 bytes
 .../embeddings/1-gpu/zimage_image_t2i.npy     | Bin 0 -> 3200 bytes
 .../2-gpu/flux_2_image_t2i_2_gpus.npy         | Bin 0 -> 3200 bytes
 .../2-gpu/flux_image_t2i_2_gpus.npy           | Bin 0 -> 3200 bytes
 .../2-gpu/qwen_image_t2i_2_gpus.npy           | Bin 0 -> 3200 bytes
 .../2-gpu/wan2_1_i2v_14b_480P_2gpu.npy        | Bin 0 -> 9344 bytes
 .../2-gpu/wan2_1_i2v_14b_720P_2gpu.npy        | Bin 0 -> 9344 bytes
 .../2-gpu/wan2_1_i2v_14b_lora_2gpu.npy        | Bin 0 -> 9344 bytes
 .../embeddings/2-gpu/wan2_1_t2v_14b_2gpu.npy  | Bin 0 -> 9344 bytes
 .../embeddings/2-gpu/wan2_2_t2v_a14b_2gpu.npy | Bin 0 -> 9344 bytes
 .../2-gpu/wan2_2_t2v_a14b_lora_2gpu.npy       | Bin 0 -> 9344 bytes
 .../test/consistency_gt/gt_metadata.json      |  10 +
 .../test/scripts/test_clip_consistency.py     | 355 ++++++++++++
 .../test/server/consistency_utils.py          | 535 ++++++++++++++++++
 .../test/server/test_server_common.py         | 221 +++++++-
 .../test/server/test_server_utils.py          | 109 ++--
 30 files changed, 1185 insertions(+), 68 deletions(-)
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/fast_hunyuan_video.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/fastwan2_2_ti2v_5b.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_2_image_t2i.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_2_ti2i.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_image_t2i.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_image_t2i_2_gpus.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/qwen_image_edit_2509_ti2i.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/qwen_image_edit_ti2i.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/qwen_image_t2i.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_1_t2v_1.3b.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_1_t2v_1_3b_lora_1gpu.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_2_i2v_a14b_2gpu.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_2_ti2v_5b.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/zimage_image_t2i.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/flux_2_image_t2i_2_gpus.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/flux_image_t2i_2_gpus.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/qwen_image_t2i_2_gpus.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_i2v_14b_480P_2gpu.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_i2v_14b_720P_2gpu.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_i2v_14b_lora_2gpu.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_t2v_14b_2gpu.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_2_t2v_a14b_2gpu.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_2_t2v_a14b_lora_2gpu.npy
 create mode 100644 python/sglang/multimodal_gen/test/consistency_gt/gt_metadata.json
 create mode 100755 python/sglang/multimodal_gen/test/scripts/test_clip_consistency.py
 create mode 100644 python/sglang/multimodal_gen/test/server/consistency_utils.py

diff --git a/.github/workflows/pr-test.yml b/.github/workflows/pr-test.yml
index 418260e1e..b719effe8 100644
--- a/.github/workflows/pr-test.yml
+++ b/.github/workflows/pr-test.yml
@@ -517,8 +517,11 @@ jobs:
       - name: Install dependencies
         run: |
           CUSTOM_BUILD_SGL_KERNEL=${{needs.check-changes.outputs.sgl_kernel}} bash scripts/ci/ci_install_dependency.sh diffusion
+
       - name: Run diffusion server tests
         timeout-minutes: 60
+        env:
+          SGLANG_GT_STAGING_DIR: ${{ runner.temp }}/gt_staging
         run: |
           cd python
           python3 sglang/multimodal_gen/test/run_suite.py \
@@ -526,6 +529,13 @@ jobs:
             --partition-id ${{ matrix.part }} \
             --total-partitions 2
 
+      - name: Upload missing GT as artifact
+        if: always()
+        uses: actions/upload-artifact@v4
+        with:
+          name: missing-gt-1gpu-part${{ matrix.part }}
+          path: ${{ runner.temp }}/gt_staging/
+          if-no-files-found: ignore
 
   multimodal-gen-test-2-gpu:
     needs: [check-changes, call-gate, sgl-kernel-build-wheels]
@@ -562,6 +572,8 @@ jobs:
 
       - name: Run diffusion server tests
         timeout-minutes: 60
+        env:
+          SGLANG_GT_STAGING_DIR: ${{ runner.temp }}/gt_staging
         run: |
           cd python
           python3 sglang/multimodal_gen/test/run_suite.py \
@@ -569,6 +581,14 @@ jobs:
             --partition-id ${{ matrix.part }} \
             --total-partitions 2
 
+      - name: Upload missing GT as artifact
+        if: always()
+        uses: actions/upload-artifact@v4
+        with:
+          name: missing-gt-2gpu-part${{ matrix.part }}
+          path: ${{ runner.temp }}/gt_staging/
+          if-no-files-found: ignore
+
   quantization-test:
       needs: [check-changes, call-gate, stage-a-test-1]
       if: |
diff --git a/python/pyproject.toml b/python/pyproject.toml
index 198792559..a3da5f6d2 100755
--- a/python/pyproject.toml
+++ b/python/pyproject.toml
@@ -89,8 +89,9 @@ diffusion = [
   "imageio==2.36.0",
   "imageio-ffmpeg==0.5.1",
   "moviepy>=2.0.0",
-  "opencv-python==4.10.0.84",
+  "opencv-python-headless==4.10.0.84",
   "remote-pdb",
+  "scikit-image>=0.21.0",  # For SSIM computation in consistency tests
   "st_attn ==0.0.7",
   "vsa==0.0.4",
   "yunchang==0.6.3.post1",
diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/fast_hunyuan_video.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/fast_hunyuan_video.npy
new file mode 100644
index 0000000000000000000000000000000000000000..d937a32264b50041759ba81c74e19e2829f40cfe
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/fastwan2_2_ti2v_5b.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/fastwan2_2_ti2v_5b.npy
new file mode 100644
index 0000000000000000000000000000000000000000..eb4d2acdead711713215cccef82f8bafceebe87f
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_2_image_t2i.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_2_image_t2i.npy
new file mode 100644
index 0000000000000000000000000000000000000000..db3d2ae0c6f1cc9b31ef7e4a33f933a42444144c
GIT binary patch
literal 3200
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
J2lKcX{4eT(?!*89

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_2_ti2i.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_2_ti2i.npy
new file mode 100644
index 0000000000000000000000000000000000000000..9eb10fa1cd1ca5ec4df24d01d1eea89b6c83f5c5
GIT binary patch
literal 3200
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
G59YtRRs}Ku

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_image_t2i.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_image_t2i.npy
new file mode 100644
index 0000000000000000000000000000000000000000..c5c73cc0bd2caca4dffb9507de3655cc22c3f23f
GIT binary patch
literal 3200
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
EU$&<PZ2$lO

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_image_t2i_2_gpus.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/flux_image_t2i_2_gpus.npy
new file mode 100644
index 0000000000000000000000000000000000000000..c5c73cc0bd2caca4dffb9507de3655cc22c3f23f
GIT binary patch
literal 3200
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
EU$&<PZ2$lO

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/qwen_image_edit_2509_ti2i.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/qwen_image_edit_2509_ti2i.npy
new file mode 100644
index 0000000000000000000000000000000000000000..4dfba906545e2f9c796a30a248725af3536bfee7
GIT binary patch
literal 3200
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
SV;3N_Rf|YxvzT*WIsO-L^5_)+

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/qwen_image_edit_ti2i.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/qwen_image_edit_ti2i.npy
new file mode 100644
index 0000000000000000000000000000000000000000..f7acb1740e2a7e118f52e741cdb99221af1a6233
GIT binary patch
literal 3200
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
Wg%8#25u(?BIDk>3I6LoI0sjNQ_XBSL

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/qwen_image_t2i.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/qwen_image_t2i.npy
new file mode 100644
index 0000000000000000000000000000000000000000..9f785bef01f8c550d52d45838c6cb42c171fd87f
GIT binary patch
literal 3200
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
Nfb6o{5b{hN{|7P&`PBdb

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_1_t2v_1.3b.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_1_t2v_1.3b.npy
new file mode 100644
index 0000000000000000000000000000000000000000..39d4f6180c8ffe07fd62677f9e18167c7880209c
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_1_t2v_1_3b_lora_1gpu.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_1_t2v_1_3b_lora_1gpu.npy
new file mode 100644
index 0000000000000000000000000000000000000000..b22b841154592391b4fba33404c7c69e69f827ff
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_2_i2v_a14b_2gpu.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_2_i2v_a14b_2gpu.npy
new file mode 100644
index 0000000000000000000000000000000000000000..f3c896136ad51a8242eab26b97a30edc7765e20e
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_2_ti2v_5b.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/wan2_2_ti2v_5b.npy
new file mode 100644
index 0000000000000000000000000000000000000000..fb2af682c3a331104ea81dc9218bc0122eb5113d
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/zimage_image_t2i.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/1-gpu/zimage_image_t2i.npy
new file mode 100644
index 0000000000000000000000000000000000000000..2f5d1a21ba68e68138f4e6e4fe3ef98eacc3ae63
GIT binary patch
literal 3200
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
UfO6k)C?J;;SbP%N^1bQ*0mCc?VE_OC

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/flux_2_image_t2i_2_gpus.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/flux_2_image_t2i_2_gpus.npy
new file mode 100644
index 0000000000000000000000000000000000000000..db3d2ae0c6f1cc9b31ef7e4a33f933a42444144c
GIT binary patch
literal 3200
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
J2lKcX{4eT(?!*89

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/flux_image_t2i_2_gpus.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/flux_image_t2i_2_gpus.npy
new file mode 100644
index 0000000000000000000000000000000000000000..05058f73afe30d4368b89df8cade4a19068bb2d6
GIT binary patch
literal 3200
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
KEnu=$68{I~BmQ*&

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/qwen_image_t2i_2_gpus.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/qwen_image_t2i_2_gpus.npy
new file mode 100644
index 0000000000000000000000000000000000000000..5f2bd094d0f7ea53548158a9bec103027413d70e
GIT binary patch
literal 3200
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
Nz})5oFfy~J@V_&J@6iAN

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_i2v_14b_480P_2gpu.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_i2v_14b_480P_2gpu.npy
new file mode 100644
index 0000000000000000000000000000000000000000..8be39d328003654042bd7e8d5dc73b42af356452
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_i2v_14b_720P_2gpu.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_i2v_14b_720P_2gpu.npy
new file mode 100644
index 0000000000000000000000000000000000000000..0f2e2a9e8d64068ffcfb9eb93963c4bbf45bd35c
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_i2v_14b_lora_2gpu.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_i2v_14b_lora_2gpu.npy
new file mode 100644
index 0000000000000000000000000000000000000000..d24d712c6b03545adad3e0d804bfc6abfe55c4e3
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_t2v_14b_2gpu.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_1_t2v_14b_2gpu.npy
new file mode 100644
index 0000000000000000000000000000000000000000..75be272acd2b5e15577e4b7aa27949e262697941
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_2_t2v_a14b_2gpu.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_2_t2v_a14b_2gpu.npy
new file mode 100644
index 0000000000000000000000000000000000000000..836dab2a864d9f2d00706a7e45f4d3f1167823e2
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_2_t2v_a14b_lora_2gpu.npy b/python/sglang/multimodal_gen/test/consistency_gt/embeddings/2-gpu/wan2_2_t2v_a14b_lora_2gpu.npy
new file mode 100644
index 0000000000000000000000000000000000000000..80ea416a97885ba51bbe1da7983da8281d2a890f
GIT binary patch
literal 9344
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

literal 0
HcmV?d00001

diff --git a/python/sglang/multimodal_gen/test/consistency_gt/gt_metadata.json b/python/sglang/multimodal_gen/test/consistency_gt/gt_metadata.json
new file mode 100644
index 000000000..1ad35ef6f
--- /dev/null
+++ b/python/sglang/multimodal_gen/test/consistency_gt/gt_metadata.json
@@ -0,0 +1,10 @@
+{
+    "version": "2.0",
+    "description": "Ground truth metadata for CLIP consistency testing",
+    "default_seed": 1024,
+    "default_generator_device": "cuda",
+    "clip_model": "openai/clip-vit-large-patch14",
+    "default_clip_threshold_image": 0.92,
+    "default_clip_threshold_video": 0.90,
+    "cases": {}
+}
diff --git a/python/sglang/multimodal_gen/test/scripts/test_clip_consistency.py b/python/sglang/multimodal_gen/test/scripts/test_clip_consistency.py
new file mode 100755
index 000000000..103f25560
--- /dev/null
+++ b/python/sglang/multimodal_gen/test/scripts/test_clip_consistency.py
@@ -0,0 +1,355 @@
+#!/usr/bin/env python3
+"""
+Test script to verify CLIP consistency checking works correctly.
+
+This script tests:
+1. Loading GT embeddings from .npy files
+2. Computing CLIP embeddings for images
+3. Computing cosine similarity between embeddings
+
+Usage:
+    python test_clip_consistency.py
+
+    # Test with a specific image
+    python test_clip_consistency.py --image /path/to/test.png --case qwen_image_t2i --num-gpus 1
+
+    # Just verify embeddings can be loaded
+    python test_clip_consistency.py --verify-only
+"""
+
+from __future__ import annotations
+
+import argparse
+import sys
+from pathlib import Path
+
+import numpy as np
+
+
+def test_load_embeddings():
+    """Test that all GT embeddings can be loaded."""
+    print("=" * 60)
+    print("Test 1: Loading GT embeddings")
+    print("=" * 60)
+
+    # Add sglang to path
+    script_dir = Path(__file__).parent
+    sglang_root = script_dir.parent.parent.parent.parent.parent
+    sys.path.insert(0, str(sglang_root))
+
+    from sglang.multimodal_gen.test.server.consistency_utils import (
+        EMBEDDINGS_DIR,
+        gt_exists,
+        load_gt_embeddings,
+    )
+
+    print(f"Embeddings directory: {EMBEDDINGS_DIR}")
+
+    # Find all .npy files
+    npy_files = list(EMBEDDINGS_DIR.rglob("*.npy"))
+    print(f"Found {len(npy_files)} embedding files\n")
+
+    success_count = 0
+    fail_count = 0
+
+    for npy_file in sorted(npy_files):
+        # Parse path to get num_gpus and case_id
+        gpu_dir = npy_file.parent.name  # e.g., "1-gpu"
+        num_gpus = int(gpu_dir.split("-")[0])
+        case_id = npy_file.stem  # e.g., "qwen_image_t2i"
+
+        try:
+            # Test gt_exists
+            exists = gt_exists(case_id, num_gpus)
+            assert exists, f"gt_exists returned False for {case_id}"
+
+            # Check raw embedding shape to determine if video or image
+            raw_emb = np.load(npy_file)
+            is_video = raw_emb.ndim == 2 and raw_emb.shape[0] > 1
+
+            # Test loading
+            embeddings = load_gt_embeddings(case_id, num_gpus, is_video=is_video)
+
+            # Verify shape based on actual data
+            expected_count = raw_emb.shape[0] if raw_emb.ndim == 2 else 1
+            assert (
+                len(embeddings) == expected_count
+            ), f"Expected {expected_count} embeddings, got {len(embeddings)}"
+
+            for emb in embeddings:
+                assert emb.shape == (768,), f"Expected shape (768,), got {emb.shape}"
+                # Verify L2 normalized (norm should be ~1.0)
+                norm = np.linalg.norm(emb)
+                assert 0.99 < norm < 1.01, f"Embedding not normalized, norm={norm}"
+
+            print(f"  ✓ {gpu_dir}/{case_id}: {len(embeddings)} embedding(s), shape OK")
+            success_count += 1
+
+        except Exception as e:
+            print(f"  ✗ {gpu_dir}/{case_id}: {e}")
+            fail_count += 1
+
+    print(f"\nResults: {success_count} passed, {fail_count} failed")
+    return fail_count == 0
+
+
+def test_clip_model():
+    """Test that CLIP model can be loaded and used."""
+    print("\n" + "=" * 60)
+    print("Test 2: Loading CLIP model")
+    print("=" * 60)
+
+    script_dir = Path(__file__).parent
+    sglang_root = script_dir.parent.parent.parent.parent.parent
+    sys.path.insert(0, str(sglang_root))
+
+    from sglang.multimodal_gen.test.server.consistency_utils import (
+        compute_clip_embedding,
+        get_clip_model,
+    )
+
+    try:
+        model, processor = get_clip_model()
+        print("  ✓ CLIP model loaded successfully")
+
+        # Create a dummy image to test embedding computation
+        dummy_image = np.random.randint(0, 255, (256, 256, 3), dtype=np.uint8)
+        emb = compute_clip_embedding(dummy_image)
+
+        assert emb.shape == (768,), f"Expected shape (768,), got {emb.shape}"
+        norm = np.linalg.norm(emb)
+        assert 0.99 < norm < 1.01, f"Embedding not normalized, norm={norm}"
+
+        print(f"  ✓ Embedding computation works, shape={emb.shape}, norm={norm:.4f}")
+        return True
+
+    except Exception as e:
+        print(f"  ✗ Error: {e}")
+        return False
+
+
+def test_similarity_computation():
+    """Test cosine similarity computation."""
+    print("\n" + "=" * 60)
+    print("Test 3: Similarity computation")
+    print("=" * 60)
+
+    script_dir = Path(__file__).parent
+    sglang_root = script_dir.parent.parent.parent.parent.parent
+    sys.path.insert(0, str(sglang_root))
+
+    from sglang.multimodal_gen.test.server.consistency_utils import (
+        compute_clip_similarity,
+    )
+
+    try:
+        # Test with identical embeddings (should be 1.0)
+        emb1 = np.random.randn(768).astype(np.float32)
+        emb1 = emb1 / np.linalg.norm(emb1)  # Normalize
+
+        sim_identical = compute_clip_similarity(emb1, emb1)
+        assert abs(sim_identical - 1.0) < 0.001, f"Expected 1.0, got {sim_identical}"
+        print(f"  ✓ Identical embeddings: similarity = {sim_identical:.4f}")
+
+        # Test with orthogonal embeddings (should be ~0.0)
+        emb2 = np.random.randn(768).astype(np.float32)
+        emb2 = emb2 - np.dot(emb2, emb1) * emb1  # Make orthogonal
+        emb2 = emb2 / np.linalg.norm(emb2)  # Normalize
+
+        sim_orthogonal = compute_clip_similarity(emb1, emb2)
+        assert abs(sim_orthogonal) < 0.1, f"Expected ~0.0, got {sim_orthogonal}"
+        print(f"  ✓ Orthogonal embeddings: similarity = {sim_orthogonal:.4f}")
+
+        # Test with opposite embeddings (should be -1.0)
+        sim_opposite = compute_clip_similarity(emb1, -emb1)
+        assert abs(sim_opposite + 1.0) < 0.001, f"Expected -1.0, got {sim_opposite}"
+        print(f"  ✓ Opposite embeddings: similarity = {sim_opposite:.4f}")
+
+        return True
+
+    except Exception as e:
+        print(f"  ✗ Error: {e}")
+        return False
+
+
+def test_compare_with_gt():
+    """Test the full comparison workflow."""
+    print("\n" + "=" * 60)
+    print("Test 4: Full comparison workflow (with dummy image)")
+    print("=" * 60)
+
+    script_dir = Path(__file__).parent
+    sglang_root = script_dir.parent.parent.parent.parent.parent
+    sys.path.insert(0, str(sglang_root))
+
+    from sglang.multimodal_gen.test.server.consistency_utils import (
+        EMBEDDINGS_DIR,
+        compare_with_gt,
+        load_gt_embeddings,
+    )
+
+    try:
+        # Find a case to test with
+        npy_files = list((EMBEDDINGS_DIR / "1-gpu").glob("*.npy"))
+        if not npy_files:
+            print("  ⚠ No 1-gpu embeddings found, skipping")
+            return True
+
+        # Use the first non-video case
+        test_file = None
+        for f in npy_files:
+            case_id = f.stem
+            if "t2v" not in case_id and "i2v" not in case_id and "ti2v" not in case_id:
+                test_file = f
+                break
+
+        if test_file is None:
+            test_file = npy_files[0]
+
+        case_id = test_file.stem
+        is_video = "t2v" in case_id or "i2v" in case_id or "ti2v" in case_id
+
+        print(f"  Testing with case: {case_id} (is_video={is_video})")
+
+        # Load GT embeddings
+        gt_embeddings = load_gt_embeddings(case_id, num_gpus=1, is_video=is_video)
+        print(f"  Loaded {len(gt_embeddings)} GT embedding(s)")
+
+        # Create dummy frames (random images won't match GT)
+        num_frames = len(gt_embeddings)
+        dummy_frames = [
+            np.random.randint(0, 255, (256, 256, 3), dtype=np.uint8)
+            for _ in range(num_frames)
+        ]
+
+        # Compare (should fail since dummy images won't match GT)
+        result = compare_with_gt(
+            output_frames=dummy_frames,
+            gt_embeddings=gt_embeddings,
+            threshold=0.92,
+            case_id=case_id,
+        )
+
+        print(
+            f"  Result: passed={result.passed}, min_similarity={result.min_similarity:.4f}"
+        )
+        print(f"  (Expected to fail since using random dummy images)")
+
+        # Now test with GT embeddings directly (simulate perfect match)
+        # Create frames that would produce the same embeddings
+        # This is a sanity check - we just verify the workflow runs
+
+        print("  ✓ Comparison workflow executed successfully")
+        return True
+
+    except Exception as e:
+        print(f"  ✗ Error: {e}")
+        import traceback
+
+        traceback.print_exc()
+        return False
+
+
+def test_with_real_image(image_path: Path, case_id: str, num_gpus: int):
+    """Test with a real image against GT."""
+    print("\n" + "=" * 60)
+    print(f"Test: Real image comparison")
+    print(f"  Image: {image_path}")
+    print(f"  Case: {case_id}")
+    print(f"  GPUs: {num_gpus}")
+    print("=" * 60)
+
+    script_dir = Path(__file__).parent
+    sglang_root = script_dir.parent.parent.parent.parent.parent
+    sys.path.insert(0, str(sglang_root))
+
+    from PIL import Image
+
+    from sglang.multimodal_gen.test.server.consistency_utils import (
+        compare_with_gt,
+        gt_exists,
+        load_gt_embeddings,
+    )
+
+    if not image_path.exists():
+        print(f"  ✗ Image not found: {image_path}")
+        return False
+
+    if not gt_exists(case_id, num_gpus):
+        print(f"  ✗ GT not found for case: {case_id} ({num_gpus}-gpu)")
+        return False
+
+    try:
+        # Load image
+        img = Image.open(image_path).convert("RGB")
+        img_array = np.array(img)
+        print(f"  Image shape: {img_array.shape}")
+
+        # Load GT
+        is_video = "t2v" in case_id or "i2v" in case_id or "ti2v" in case_id
+        gt_embeddings = load_gt_embeddings(case_id, num_gpus, is_video=is_video)
+
+        # Compare
+        result = compare_with_gt(
+            output_frames=[img_array],
+            gt_embeddings=gt_embeddings[:1],  # Use first GT embedding only
+            threshold=0.92,
+            case_id=case_id,
+        )
+
+        print(f"\n  Result: {'PASSED' if result.passed else 'FAILED'}")
+        print(f"  Similarity: {result.similarity_scores[0]:.4f}")
+        print(f"  Threshold: {result.threshold}")
+
+        return result.passed
+
+    except Exception as e:
+        print(f"  ✗ Error: {e}")
+        import traceback
+
+        traceback.print_exc()
+        return False
+
+
+def main():
+    parser = argparse.ArgumentParser(description="Test CLIP consistency checking")
+    parser.add_argument(
+        "--verify-only",
+        action="store_true",
+        help="Only verify embeddings can be loaded",
+    )
+    parser.add_argument("--image", type=Path, help="Path to test image")
+    parser.add_argument("--case", type=str, help="Case ID to test against")
+    parser.add_argument("--num-gpus", type=int, default=1, help="Number of GPUs")
+
+    args = parser.parse_args()
+
+    if args.image:
+        if not args.case:
+            print("Error: --case is required when using --image")
+            sys.exit(1)
+        success = test_with_real_image(args.image, args.case, args.num_gpus)
+        sys.exit(0 if success else 1)
+
+    # Run all tests
+    all_passed = True
+
+    all_passed &= test_load_embeddings()
+
+    if not args.verify_only:
+        all_passed &= test_clip_model()
+        all_passed &= test_similarity_computation()
+        all_passed &= test_compare_with_gt()
+
+    print("\n" + "=" * 60)
+    if all_passed:
+        print("All tests PASSED ✓")
+    else:
+        print("Some tests FAILED ✗")
+    print("=" * 60)
+
+    sys.exit(0 if all_passed else 1)
+
+
+if __name__ == "__main__":
+    main()
diff --git a/python/sglang/multimodal_gen/test/server/consistency_utils.py b/python/sglang/multimodal_gen/test/server/consistency_utils.py
new file mode 100644
index 000000000..005d49e2d
--- /dev/null
+++ b/python/sglang/multimodal_gen/test/server/consistency_utils.py
@@ -0,0 +1,535 @@
+"""
+Utility functions for consistency testing of diffusion models.
+
+This module provides functions for:
+- Loading and comparing ground truth (GT) CLIP embeddings
+- Computing CLIP similarity metrics
+- Extracting key frames from videos
+- Saving GT embeddings for consistency testing
+"""
+
+from __future__ import annotations
+
+import json
+import os
+import tempfile
+from dataclasses import dataclass
+from pathlib import Path
+from typing import Any
+
+import numpy as np
+from PIL import Image
+
+from sglang.multimodal_gen.runtime.utils.logging_utils import init_logger
+from sglang.multimodal_gen.test.server.testcase_configs import DiffusionTestCase
+
+logger = init_logger(__name__)
+
+# Path to the GT metadata file (kept in sglang repo)
+GT_METADATA_PATH = Path(__file__).parent.parent / "consistency_gt" / "gt_metadata.json"
+
+# Path to the embeddings directory (kept in sglang repo)
+EMBEDDINGS_DIR = Path(__file__).parent.parent / "consistency_gt" / "embeddings"
+
+# CLIP configuration
+CLIP_MODEL_NAME = "openai/clip-vit-large-patch14"
+
+# Default thresholds
+DEFAULT_CLIP_THRESHOLD_IMAGE = 0.92
+DEFAULT_CLIP_THRESHOLD_VIDEO = 0.90
+DEFAULT_SEED = 1024
+DEFAULT_GENERATOR_DEVICE = "cuda"
+
+# Environment variable for staging directory
+GT_STAGING_DIR_ENV = "SGLANG_GT_STAGING_DIR"
+
+# Global cache for CLIP model (singleton pattern)
+_clip_model_cache: dict[str, Any] = {}
+
+
+@dataclass
+class ConsistencyConfig:
+    """Configuration for a consistency test case."""
+
+    case_id: str
+    num_gpus: int
+    seed: int
+    generator_device: str
+    clip_threshold: float
+    key_frame_indices: list[
+        int | str
+    ]  # int for specific index, "mid", "last" for dynamic
+    resolution: str | None = None
+    num_frames: int | None = None
+
+
+@dataclass
+class ConsistencyResult:
+    """Result of a consistency comparison."""
+
+    case_id: str
+    passed: bool
+    similarity_scores: list[float]
+    min_similarity: float
+    threshold: float
+    frame_details: list[dict[str, Any]]
+
+
+def load_gt_metadata() -> dict[str, Any]:
+    """Load the ground truth metadata from gt_metadata.json."""
+    if not GT_METADATA_PATH.exists():
+        logger.warning(f"GT metadata not found at {GT_METADATA_PATH}")
+        return {"cases": {}}
+
+    with GT_METADATA_PATH.open("r", encoding="utf-8") as f:
+        return json.load(f)
+
+
+def save_gt_metadata(metadata: dict[str, Any]) -> None:
+    """Save the ground truth metadata to gt_metadata.json."""
+    GT_METADATA_PATH.parent.mkdir(parents=True, exist_ok=True)
+    with GT_METADATA_PATH.open("w", encoding="utf-8") as f:
+        json.dump(metadata, f, indent=4)
+
+
+def get_staging_dir() -> Path | None:
+    """Get the staging directory from environment variable.
+
+    Returns:
+        Path to staging directory, or None if not set.
+    """
+    staging_dir = os.environ.get(GT_STAGING_DIR_ENV)
+    if staging_dir:
+        return Path(staging_dir)
+    return None
+
+
+def get_clip_model() -> tuple[Any, Any]:
+    """
+    Get CLIP model and processor (lazy loading with singleton pattern).
+
+    Returns:
+        Tuple of (model, processor)
+
+    Raises:
+        ImportError: If transformers is not installed
+    """
+    global _clip_model_cache
+
+    if "model" not in _clip_model_cache:
+        try:
+            import torch
+            from transformers import CLIPModel, CLIPProcessor
+        except ImportError:
+            raise ImportError(
+                "transformers and torch are required for CLIP consistency check. "
+                "Install with: pip install transformers torch"
+            )
+
+        logger.info(f"Loading CLIP model: {CLIP_MODEL_NAME}")
+        processor = CLIPProcessor.from_pretrained(CLIP_MODEL_NAME)
+        model = CLIPModel.from_pretrained(CLIP_MODEL_NAME)
+
+        # Move to GPU if available
+        device = "cuda" if torch.cuda.is_available() else "cpu"
+        model = model.to(device)
+        model.eval()
+
+        _clip_model_cache["model"] = model
+        _clip_model_cache["processor"] = processor
+        _clip_model_cache["device"] = device
+        logger.info(f"CLIP model loaded on {device}")
+
+    return _clip_model_cache["model"], _clip_model_cache["processor"]
+
+
+def compute_clip_embedding(image: np.ndarray) -> np.ndarray:
+    """
+    Compute CLIP embedding for a single image.
+
+    Args:
+        image: numpy array (H, W, C) in RGB format
+
+    Returns:
+        768-dimensional numpy array (L2 normalized)
+    """
+    try:
+        import torch
+    except ImportError:
+        raise ImportError(
+            "torch is required for CLIP consistency check. "
+            "Install with: pip install torch"
+        )
+
+    model, processor = get_clip_model()
+    device = _clip_model_cache["device"]
+
+    # Convert numpy to PIL Image
+    pil_image = Image.fromarray(image)
+
+    # Process image
+    inputs = processor(images=pil_image, return_tensors="pt")
+    inputs = {k: v.to(device) for k, v in inputs.items()}
+
+    # Get embedding
+    with torch.no_grad():
+        image_features = model.get_image_features(**inputs)
+        # L2 normalize
+        image_features = image_features / image_features.norm(dim=-1, keepdim=True)
+
+    return image_features.cpu().numpy().flatten()
+
+
+def compute_clip_similarity(emb1: np.ndarray, emb2: np.ndarray) -> float:
+    """
+    Compute cosine similarity between two CLIP embeddings.
+
+    Args:
+        emb1: 768-dimensional numpy array
+        emb2: 768-dimensional numpy array
+
+    Returns:
+        Cosine similarity score [-1, 1], typically [0.5, 1.0] for images
+    """
+    # Both embeddings should already be L2 normalized
+    # Cosine similarity = dot product for normalized vectors
+    similarity = np.dot(emb1, emb2)
+    return float(similarity)
+
+
+def load_gt_embeddings(
+    case_id: str, num_gpus: int, is_video: bool = False
+) -> list[np.ndarray]:
+    """
+    Load ground truth CLIP embeddings for a specific case.
+
+    Args:
+        case_id: Test case identifier.
+        num_gpus: Number of GPUs used.
+        is_video: Whether this is a video case (default: False).
+
+    Returns:
+        List of numpy arrays (embeddings) for each key frame.
+        Image: 1 embedding, Video: 3 embeddings (first, mid, last)
+
+    Raises:
+        FileNotFoundError: If GT embeddings are not available.
+    """
+    embedding_path = EMBEDDINGS_DIR / f"{num_gpus}-gpu" / f"{case_id}.npy"
+
+    if not embedding_path.exists():
+        raise FileNotFoundError(
+            f"GT embedding not found at {embedding_path}. "
+            f"Please generate GT embeddings first."
+        )
+
+    embeddings = np.load(embedding_path)
+
+    # Handle shape: (768,) for image, (3, 768) for video
+    if embeddings.ndim == 1:
+        embeddings = [embeddings]
+    else:
+        embeddings = list(embeddings)
+
+    logger.info(
+        f"Loaded {len(embeddings)} GT embeddings for {case_id} from {embedding_path}"
+    )
+    return embeddings
+
+
+def extract_key_frames_from_video(
+    video_bytes: bytes,
+    num_frames: int | None = None,
+) -> list[np.ndarray]:
+    """
+    Extract key frames (first, middle, last) from video bytes.
+
+    Args:
+        video_bytes: Raw video bytes (MP4 format)
+        num_frames: Total number of frames (if known), used for validation
+
+    Returns:
+        List of numpy arrays [first_frame, middle_frame, last_frame].
+        Always returns exactly 3 frames to ensure consistency with GT naming.
+        For very short videos, frames may be duplicated.
+    """
+    try:
+        import cv2
+    except ImportError:
+        raise ImportError(
+            "opencv-python is required for video frame extraction. "
+            "Install it with: pip install opencv-python"
+        )
+
+    # Write video to temporary file for OpenCV to read
+    with tempfile.NamedTemporaryFile(suffix=".mp4", delete=False) as tmp:
+        tmp.write(video_bytes)
+        tmp_path = tmp.name
+
+    try:
+        cap = cv2.VideoCapture(tmp_path)
+        if not cap.isOpened():
+            raise ValueError("Failed to open video file")
+
+        total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
+        if total_frames < 1:
+            raise ValueError("Video has no frames")
+
+        # Calculate key frame indices
+        first_idx = 0
+        mid_idx = total_frames // 2
+        last_idx = total_frames - 1
+
+        # Always use 3 indices to ensure consistent frame count for GT naming
+        # (frame_0.png, frame_mid.png, frame_last.png)
+        # For very short videos, some indices may be duplicated
+        key_indices = [first_idx, mid_idx, last_idx]
+
+        frames = []
+        for idx in key_indices:
+            cap.set(cv2.CAP_PROP_POS_FRAMES, idx)
+            ret, frame = cap.read()
+            if not ret:
+                raise ValueError(f"Failed to read frame at index {idx}")
+            # Convert BGR to RGB
+            frame_rgb = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
+            frames.append(frame_rgb)
+
+        cap.release()
+        logger.info(
+            f"Extracted {len(frames)} key frames from video "
+            f"(total: {total_frames}, indices: {key_indices})"
+        )
+        return frames
+
+    finally:
+        os.unlink(tmp_path)
+
+
+def image_bytes_to_numpy(image_bytes: bytes) -> np.ndarray:
+    """Convert image bytes to numpy array."""
+    import io
+
+    img = Image.open(io.BytesIO(image_bytes)).convert("RGB")
+    return np.array(img)
+
+
+def compare_with_gt(
+    output_frames: list[np.ndarray],
+    gt_embeddings: list[np.ndarray],
+    threshold: float,
+    case_id: str,
+) -> ConsistencyResult:
+    """
+    Compare output frames with ground truth embeddings using CLIP similarity.
+
+    Args:
+        output_frames: List of output frames as numpy arrays
+        gt_embeddings: List of GT CLIP embeddings
+        threshold: Similarity threshold for passing
+        case_id: Test case identifier
+
+    Returns:
+        ConsistencyResult with comparison details
+    """
+    if len(output_frames) != len(gt_embeddings):
+        raise ValueError(
+            f"Frame count mismatch: output={len(output_frames)}, gt={len(gt_embeddings)}"
+        )
+
+    similarity_scores = []
+    frame_details = []
+
+    for i, (out_frame, gt_emb) in enumerate(zip(output_frames, gt_embeddings)):
+        # Compute CLIP embedding for output frame
+        out_emb = compute_clip_embedding(out_frame)
+
+        # Compute similarity
+        similarity = compute_clip_similarity(out_emb, gt_emb)
+        similarity_scores.append(similarity)
+        frame_details.append(
+            {
+                "frame_index": i,
+                "similarity": similarity,
+                "passed": similarity >= threshold,
+                "output_shape": out_frame.shape,
+            }
+        )
+
+    min_similarity = min(similarity_scores)
+    passed = all(s >= threshold for s in similarity_scores)
+
+    result = ConsistencyResult(
+        case_id=case_id,
+        passed=passed,
+        similarity_scores=similarity_scores,
+        min_similarity=min_similarity,
+        threshold=threshold,
+        frame_details=frame_details,
+    )
+
+    # Always print detailed similarity info
+    status = "PASSED" if passed else "FAILED"
+    print(f"\n{'='*60}")
+    print(f"[CLIP Consistency] {case_id}: {status}")
+    print(f"  Threshold: {threshold}")
+    print(f"  Min similarity: {min_similarity:.4f}")
+    print(f"  Frame details:")
+    for detail in frame_details:
+        frame_status = "✓" if detail["passed"] else "✗"
+        print(
+            f"    Frame {detail['frame_index']}: similarity={detail['similarity']:.4f} {frame_status}"
+        )
+    print(f"{'='*60}\n")
+
+    if passed:
+        logger.info(
+            f"[Consistency] {case_id}: PASSED (min_similarity={min_similarity:.4f}, threshold={threshold})"
+        )
+    else:
+        logger.error(
+            f"[Consistency] {case_id}: FAILED (min_similarity={min_similarity:.4f}, threshold={threshold})"
+        )
+        for detail in frame_details:
+            if not detail["passed"]:
+                logger.error(
+                    f"  Frame {detail['frame_index']}: similarity={detail['similarity']:.4f} < {threshold}"
+                )
+
+    return result
+
+
+def get_consistency_config(
+    case: DiffusionTestCase,
+    metadata: dict[str, Any] | None = None,
+) -> ConsistencyConfig:
+    """
+    Get consistency configuration for a test case.
+
+    Uses metadata if available, otherwise uses defaults.
+    """
+    if metadata is None:
+        metadata = load_gt_metadata()
+
+    case_meta = metadata.get("cases", {}).get(case.id, {})
+
+    # Determine if this is image or video
+    is_video = case.server_args.modality == "video"
+
+    # Get threshold (use case-specific if available, otherwise default)
+    default_threshold = (
+        metadata.get("default_clip_threshold_video", DEFAULT_CLIP_THRESHOLD_VIDEO)
+        if is_video
+        else metadata.get("default_clip_threshold_image", DEFAULT_CLIP_THRESHOLD_IMAGE)
+    )
+    threshold = case_meta.get("clip_threshold", default_threshold)
+
+    # Get key frame indices
+    if is_video:
+        key_frame_indices = case_meta.get("key_frame_indices", [0, "mid", "last"])
+    else:
+        key_frame_indices = [0]
+
+    return ConsistencyConfig(
+        case_id=case.id,
+        num_gpus=case.server_args.num_gpus,
+        seed=case_meta.get("seed", metadata.get("default_seed", DEFAULT_SEED)),
+        generator_device=case_meta.get(
+            "generator_device",
+            metadata.get("default_generator_device", DEFAULT_GENERATOR_DEVICE),
+        ),
+        clip_threshold=threshold,
+        key_frame_indices=key_frame_indices,
+        resolution=case.sampling_params.output_size,
+        num_frames=case.sampling_params.num_frames,
+    )
+
+
+def save_embeddings_as_gt(
+    frames: list[np.ndarray],
+    case_id: str,
+    num_gpus: int,
+    is_video: bool = False,
+    output_dir: Path | None = None,
+) -> Path:
+    """
+    Convert frames to CLIP embeddings and save as .npy file.
+
+    Args:
+        frames: List of frames as numpy arrays
+        case_id: Test case identifier
+        num_gpus: Number of GPUs used
+        is_video: Whether this is a video (affects expected frame count)
+        output_dir: Output directory (defaults to EMBEDDINGS_DIR)
+
+    Returns:
+        Path to the saved .npy file
+    """
+    if output_dir is None:
+        output_dir = EMBEDDINGS_DIR
+
+    case_dir = output_dir / f"{num_gpus}-gpu"
+    case_dir.mkdir(parents=True, exist_ok=True)
+
+    # Compute embeddings for all frames
+    embeddings = []
+    for frame in frames:
+        emb = compute_clip_embedding(frame)
+        embeddings.append(emb)
+
+    # Stack embeddings: (768,) for single frame, (N, 768) for multiple
+    if len(embeddings) == 1:
+        embeddings_array = embeddings[0]
+    else:
+        embeddings_array = np.stack(embeddings)
+
+    # Save as .npy
+    output_path = case_dir / f"{case_id}.npy"
+    np.save(output_path, embeddings_array)
+    logger.info(f"Saved GT embeddings: {output_path} (shape: {embeddings_array.shape})")
+
+    return output_path
+
+
+def gt_exists(case_id: str, num_gpus: int) -> bool:
+    """Check if GT embedding exists locally."""
+    embedding_path = EMBEDDINGS_DIR / f"{num_gpus}-gpu" / f"{case_id}.npy"
+    return embedding_path.exists()
+
+
+def save_gt_to_staging(
+    frames: list[np.ndarray],
+    case: DiffusionTestCase,
+    is_video: bool,
+) -> Path | None:
+    """
+    Save GT embeddings to staging directory for later commit to sglang repo.
+
+    This function is called when GT doesn't exist during test execution.
+    The staging directory can be committed directly to the sglang repository.
+
+    Args:
+        frames: List of frames as numpy arrays
+        case: Test case configuration
+        is_video: Whether this is a video (affects frame naming)
+
+    Returns:
+        Path to saved GT embedding file, or None if staging is not enabled.
+    """
+    staging_dir = get_staging_dir()
+    if staging_dir is None:
+        return None
+
+    num_gpus = case.server_args.num_gpus
+    case_id = case.id
+
+    gt_path = save_embeddings_as_gt(
+        frames=frames,
+        case_id=case_id,
+        num_gpus=num_gpus,
+        is_video=is_video,
+        output_dir=staging_dir,
+    )
+
+    logger.info(f"[Staging] Saved GT embeddings for {case_id} to {gt_path}")
+    return gt_path
diff --git a/python/sglang/multimodal_gen/test/server/test_server_common.py b/python/sglang/multimodal_gen/test/server/test_server_common.py
index 02c80380b..8c2f4410b 100644
--- a/python/sglang/multimodal_gen/test/server/test_server_common.py
+++ b/python/sglang/multimodal_gen/test/server/test_server_common.py
@@ -1,6 +1,9 @@
 """
-Config-driven diffusion performance test with pytest parametrization.
+Config-driven diffusion generation test with pytest parametrization.
 
+This module provides:
+- Performance validation against baselines
+- Consistency validation against ground truth (GT)
 
 If the actual run is significantly better than the baseline, the improved cases with their updated baseline will be printed
 """
@@ -19,6 +22,15 @@ from openai import OpenAI
 from sglang.multimodal_gen.runtime.utils.logging_utils import init_logger
 from sglang.multimodal_gen.runtime.utils.perf_logger import RequestPerfRecord
 from sglang.multimodal_gen.test.server.conftest import _GLOBAL_PERF_RESULTS
+from sglang.multimodal_gen.test.server.consistency_utils import (
+    compare_with_gt,
+    extract_key_frames_from_video,
+    get_consistency_config,
+    gt_exists,
+    image_bytes_to_numpy,
+    load_gt_embeddings,
+    save_gt_to_staging,
+)
 from sglang.multimodal_gen.test.server.test_server_utils import (
     VALIDATOR_REGISTRY,
     PerformanceValidator,
@@ -170,15 +182,19 @@ Consider updating perf_baselines.json with the snippets below:
         self,
         ctx: ServerContext,
         case_id: str,
-        generate_fn: Callable[[str, openai.Client], str],
-    ) -> RequestPerfRecord:
-        """Run generation and collect performance records."""
+        generate_fn: Callable[[str, openai.Client], tuple[str, bytes]],
+    ) -> tuple[RequestPerfRecord, bytes]:
+        """Run generation and collect performance records.
+
+        Returns:
+            Tuple of (performance_record, content_bytes)
+        """
         log_path = ctx.perf_log_path
         prev_len = len(read_perf_logs(log_path))
         log_wait_timeout = 30
 
         client = self._client(ctx)
-        rid = generate_fn(case_id, client)
+        rid, content = generate_fn(case_id, client)
 
         req_perf_record, _ = wait_for_req_perf_record(
             rid,
@@ -187,7 +203,7 @@ Consider updating perf_baselines.json with the snippets below:
             timeout=log_wait_timeout,
         )
 
-        return req_perf_record
+        return (req_perf_record, content)
 
     def _validate_and_record(
         self,
@@ -380,11 +396,151 @@ Consider updating perf_baselines.json with the snippets below:
 """
         logger.error(output)
 
+    def _validate_consistency(
+        self,
+        case: DiffusionTestCase,
+        content: bytes,
+    ) -> None:
+        """Validate output consistency against ground truth using CLIP similarity.
+
+        Args:
+            case: Test case configuration
+            content: Generated content bytes (image or video)
+
+        Raises:
+            pytest.fail: If consistency check fails (GT exists but doesn't match)
+
+        Note:
+            If GT doesn't exist, the test is skipped (not failed) with a message
+            to run the GT generation workflow after PR is merged.
+
+        Environment Variables:
+            SGLANG_SKIP_CONSISTENCY: Set to "1" to skip consistency checks
+        """
+        # Allow skipping consistency checks for debugging/development
+        if os.environ.get("SGLANG_SKIP_CONSISTENCY", "0") == "1":
+            logger.info(
+                f"[Consistency] Skipping consistency check for {case.id} (SGLANG_SKIP_CONSISTENCY=1)"
+            )
+            return
+
+        # Skip if content is empty (e.g., video generation timed out)
+        if not content:
+            logger.warning(
+                f"[Consistency] Skipping consistency check for {case.id}: "
+                "content is empty (generation may have timed out)"
+            )
+            return
+
+        num_gpus = case.server_args.num_gpus
+        is_video = case.server_args.modality == "video"
+
+        # Check GT exists - if not, save to staging and fail
+        if not gt_exists(case.id, num_gpus):
+            # Convert output to frames for staging
+            # Wrap in try-except to preserve helpful error message even if content is invalid
+            staging_path = None
+            try:
+                if is_video:
+                    output_frames = extract_key_frames_from_video(content)
+                else:
+                    output_frames = [image_bytes_to_numpy(content)]
+
+                # Save to staging directory if enabled
+                staging_path = save_gt_to_staging(output_frames, case, is_video)
+            except Exception as frame_err:
+                logger.warning(
+                    f"[Consistency] Failed to extract frames for staging: {frame_err}. "
+                    "GT guidance will still be shown."
+                )
+
+            # Build helpful error message
+            gpu_dir = f"{num_gpus}-gpu"
+
+            error_msg = f"""
+--- MISSING GROUND TRUTH DETECTED ---
+GT embedding not found for '{case.id}' ({num_gpus}-gpu).
+
+"""
+            if staging_path:
+                error_msg += f"""GT embeddings have been generated and saved to staging directory.
+These are available in the 'missing-gt' CI artifact.
+
+To add GT embeddings to pass consistency tests:
+1. Download the 'missing-gt' artifact from this CI run
+
+2. Copy the embedding file to the sglang repository:
+   cp <downloaded-artifact>/{gpu_dir}/{case.id}.npy \\
+      python/sglang/multimodal_gen/test/consistency_gt/embeddings/{gpu_dir}/
+
+3. Commit and push:
+   git add python/sglang/multimodal_gen/test/consistency_gt/embeddings/
+   git commit -m "Add consistency GT embedding for {case.id}"
+   git push
+
+4. Re-run this CI after the commit is merged.
+"""
+            else:
+                error_msg += f"""GT staging is not enabled. To generate GT embeddings:
+1. Set environment variable: SGLANG_GT_STAGING_DIR=/path/to/staging
+2. Re-run this test to generate GT embeddings
+3. Copy the generated .npy file to:
+   python/sglang/multimodal_gen/test/consistency_gt/embeddings/{gpu_dir}/{case.id}.npy
+"""
+            error_msg += f"""
+(Optional) Add custom CLIP threshold to gt_metadata.json if needed:
+   "{case.id}": {{
+       "clip_threshold": 0.92
+   }}
+"""
+            logger.error(error_msg)
+            pytest.fail(
+                f"GT embedding not found for {case.id}. See logs for instructions to add GT."
+            )
+
+        # Load GT embeddings
+        gt_embeddings = load_gt_embeddings(case.id, num_gpus, is_video=is_video)
+
+        # Convert output to frames
+        if is_video:
+            output_frames = extract_key_frames_from_video(content)
+        else:
+            output_frames = [image_bytes_to_numpy(content)]
+
+        # Get consistency config for threshold
+        config = get_consistency_config(case)
+
+        # Compare frames with GT embeddings using CLIP similarity
+        result = compare_with_gt(
+            output_frames=output_frames,
+            gt_embeddings=gt_embeddings,
+            threshold=config.clip_threshold,
+            case_id=case.id,
+        )
+
+        if not result.passed:
+            # Build detailed failure message
+            failed_frames = [
+                f"  Frame {d['frame_index']}: similarity={d['similarity']:.4f}"
+                for d in result.frame_details
+                if not d["passed"]
+            ]
+            pytest.fail(
+                f"Consistency check failed for {case.id}:\n"
+                f"  Min similarity: {result.min_similarity:.4f}\n"
+                f"  Threshold: {result.threshold}\n"
+                f"  Failed frames:\n" + "\n".join(failed_frames)
+            )
+
+        logger.info(
+            f"[Consistency] {case.id}: PASSED (min_similarity={result.min_similarity:.4f})"
+        )
+
     def _test_lora_api_functionality(
         self,
         ctx: ServerContext,
         case: DiffusionTestCase,
-        generate_fn: Callable[[str, openai.Client], str],
+        generate_fn: Callable[[str, openai.Client], tuple[str, bytes]],
     ) -> None:
         """
         Test LoRA API functionality with end-to-end validation: merge, unmerge, and set_lora.
@@ -399,8 +555,8 @@ Consider updating perf_baselines.json with the snippets below:
         assert resp.status_code == 200, f"unmerge_lora_weights failed: {resp.text}"
 
         logger.info("[LoRA E2E] Verifying generation after unmerge for %s", case.id)
-        output_after_unmerge = generate_fn(case.id, client)
-        assert output_after_unmerge is not None, "Generation after unmerge failed"
+        rid_after_unmerge, _ = generate_fn(case.id, client)
+        assert rid_after_unmerge is not None, "Generation after unmerge failed"
         logger.info("[LoRA E2E] Generation after unmerge succeeded")
 
         # Test 2: merge_lora_weights - API should succeed and generation should work
@@ -409,8 +565,8 @@ Consider updating perf_baselines.json with the snippets below:
         assert resp.status_code == 200, f"merge_lora_weights failed: {resp.text}"
 
         logger.info("[LoRA E2E] Verifying generation after re-merge for %s", case.id)
-        output_after_merge = generate_fn(case.id, client)
-        assert output_after_merge is not None, "Generation after merge failed"
+        rid_after_merge, _ = generate_fn(case.id, client)
+        assert rid_after_merge is not None, "Generation after merge failed"
         logger.info("[LoRA E2E] Generation after merge succeeded")
 
         # Test 3: set_lora (re-set the same adapter) - API should succeed and generation should work
@@ -419,8 +575,8 @@ Consider updating perf_baselines.json with the snippets below:
         assert resp.status_code == 200, f"set_lora failed: {resp.text}"
 
         logger.info("[LoRA E2E] Verifying generation after set_lora for %s", case.id)
-        output_after_set = generate_fn(case.id, client)
-        assert output_after_set is not None, "Generation after set_lora failed"
+        rid_after_set, _ = generate_fn(case.id, client)
+        assert rid_after_set is not None, "Generation after set_lora failed"
         logger.info("[LoRA E2E] Generation after set_lora succeeded")
 
         logger.info("[LoRA E2E] All LoRA API E2E tests passed for %s", case.id)
@@ -429,7 +585,7 @@ Consider updating perf_baselines.json with the snippets below:
         self,
         ctx: ServerContext,
         case: DiffusionTestCase,
-        generate_fn: Callable[[str, openai.Client], str],
+        generate_fn: Callable[[str, openai.Client], tuple[str, bytes]],
         second_lora_path: str,
     ) -> None:
         """
@@ -444,8 +600,8 @@ Consider updating perf_baselines.json with the snippets below:
         logger.info(
             "[LoRA Switch E2E] Testing generation with initial LoRA for %s", case.id
         )
-        output_initial = generate_fn(case.id, client)
-        assert output_initial is not None, "Generation with initial LoRA failed"
+        rid_initial, _ = generate_fn(case.id, client)
+        assert rid_initial is not None, "Generation with initial LoRA failed"
         logger.info("[LoRA Switch E2E] Generation with initial LoRA succeeded")
 
         # Test 2: Switch to second LoRA and generate
@@ -463,8 +619,8 @@ Consider updating perf_baselines.json with the snippets below:
         logger.info(
             "[LoRA Switch E2E] Verifying generation with second LoRA for %s", case.id
         )
-        output_second = generate_fn(case.id, client)
-        assert output_second is not None, "Generation with second LoRA failed"
+        rid_second, _ = generate_fn(case.id, client)
+        assert rid_second is not None, "Generation with second LoRA failed"
         logger.info("[LoRA Switch E2E] Generation with second LoRA succeeded")
 
         # Test 3: Switch back to original LoRA and generate
@@ -476,42 +632,55 @@ Consider updating perf_baselines.json with the snippets below:
             "[LoRA Switch E2E] Verifying generation after switching back for %s",
             case.id,
         )
-        output_switched_back = generate_fn(case.id, client)
-        assert (
-            output_switched_back is not None
-        ), "Generation after switching back failed"
+        rid_switched_back, _ = generate_fn(case.id, client)
+        assert rid_switched_back is not None, "Generation after switching back failed"
         logger.info("[LoRA Switch E2E] Generation after switching back succeeded")
 
         logger.info(
             "[LoRA Switch E2E] All dynamic switch E2E tests passed for %s", case.id
         )
 
-    def test_diffusion_perf(
+    def test_diffusion_generation(
         self,
         case: DiffusionTestCase,
         diffusion_server: ServerContext,
     ):
         """Single parametrized test that runs for all cases.
 
+        This test performs:
+        1. Generation with fixed seed for reproducibility
+        2. Performance validation against baselines
+        3. Consistency validation against ground truth
+
         Pytest will execute this test once per case in ONE_GPU_CASES,
         with test IDs like:
-        - test_diffusion_perf[qwen_image_text]
-        - test_diffusion_perf[qwen_image_edit]
+        - test_diffusion_generation[qwen_image_text]
+        - test_diffusion_generation[qwen_image_edit]
         - etc.
         """
+        # Fixed seed for consistency testing
+        consistency_seed = 1024
+
         generate_fn = get_generate_fn(
             model_path=case.server_args.model_path,
             modality=case.server_args.modality,
             sampling_params=case.sampling_params,
+            seed=consistency_seed,
         )
-        perf_record = self.run_and_collect(
+
+        # Single generation - output is reused for both validations
+        perf_record, content = self.run_and_collect(
             diffusion_server,
             case.id,
             generate_fn,
         )
 
+        # Validation 1: Performance
         self._validate_and_record(case, perf_record)
 
+        # Validation 2: Consistency (reuse the same content)
+        self._validate_consistency(case, content)
+
         # LoRA API functionality test with E2E validation (only for LoRA-enabled cases)
         if case.server_args.lora_path:
             self._test_lora_api_functionality(diffusion_server, case, generate_fn)
diff --git a/python/sglang/multimodal_gen/test/server/test_server_utils.py b/python/sglang/multimodal_gen/test/server/test_server_utils.py
index 08ca84284..4984a57da 100644
--- a/python/sglang/multimodal_gen/test/server/test_server_utils.py
+++ b/python/sglang/multimodal_gen/test/server/test_server_utils.py
@@ -479,8 +479,19 @@ def get_generate_fn(
     model_path: str,
     modality: str,
     sampling_params: DiffusionSamplingParams,
-) -> Callable[[str, Client], str]:
-    """Return appropriate generation function for the case."""
+    seed: int | None = None,
+) -> Callable[[str, Client], tuple[str, bytes]]:
+    """Return appropriate generation function for the case.
+
+    Args:
+        model_path: Path to the model
+        modality: "image" or "video"
+        sampling_params: Sampling parameters for generation
+        seed: Optional seed for reproducibility (used for consistency testing)
+
+    Returns:
+        A function that takes (case_id, client) and returns (request_id, content_bytes)
+    """
 
     def _create_and_download_video(
         client,
@@ -491,10 +502,13 @@ def get_generate_fn(
         prompt: str | None = None,
         seconds: int | None = None,
         input_reference: Any | None = None,
-    ) -> str:
+    ) -> tuple[str, bytes]:
         """
         Create a video job via /v1/videos, poll until completion,
         then download the binary content and validate it.
+
+        Returns:
+            Tuple of (video_id, video_content_bytes)
         """
 
         create_kwargs: dict[str, Any] = {
@@ -507,6 +521,9 @@ def get_generate_fn(
             create_kwargs["seconds"] = seconds
         if input_reference is not None:
             create_kwargs["input_reference"] = input_reference  # triggers multipart
+        # Use extra_body for sglang-specific parameters (seed is not in OpenAI SDK)
+        if seed is not None:
+            create_kwargs["extra_body"] = {"seed": seed}
 
         job = client.videos.create(**create_kwargs)  # type: ignore[attr-defined]
         video_id = job.id
@@ -531,12 +548,12 @@ def get_generate_fn(
         if not job_completed:
             if is_baseline_generation_mode:
                 logger.warning(
-                    f"{id}: video job {video_id} timed out during baseline generation. "
+                    f"{case_id}: video job {video_id} timed out during baseline generation. "
                     "Attempting to collect performance data anyway."
                 )
-                return video_id
+                return (video_id, b"")
 
-            pytest.fail(f"{id}: video job {video_id} did not complete in time")
+            pytest.fail(f"{case_id}: video job {video_id} did not complete in time")
 
         # download video
         resp = client.videos.download_content(video_id=video_id)  # type: ignore[attr-defined]
@@ -555,22 +572,27 @@ def get_generate_fn(
         )
         os.remove(tmp_path)
 
-        return video_id
+        return (video_id, content)
 
     video_seconds = sampling_params.seconds or 4
 
-    def generate_image(case_id, client) -> str:
+    def generate_image(case_id, client) -> tuple[str, bytes]:
         """T2I: Text to Image generation."""
         if not sampling_params.prompt:
-            pytest.skip(f"{id}: no text prompt configured")
+            pytest.skip(f"{case_id}: no text prompt configured")
+
+        generate_kwargs: dict[str, Any] = {
+            "model": model_path,
+            "prompt": sampling_params.prompt,
+            "n": 1,
+            "size": sampling_params.output_size,
+            "response_format": "b64_json",
+        }
+        # Use extra_body for sglang-specific parameters (seed is not in OpenAI SDK)
+        if seed is not None:
+            generate_kwargs["extra_body"] = {"seed": seed}
 
-        response = client.images.with_raw_response.generate(
-            model=model_path,
-            prompt=sampling_params.prompt,
-            n=1,
-            size=sampling_params.output_size,
-            response_format="b64_json",
-        )
+        response = client.images.with_raw_response.generate(**generate_kwargs)
         result = response.parse()
         validate_image(result.data[0].b64_json)
 
@@ -586,12 +608,12 @@ def get_generate_fn(
         )
         os.remove(tmp_path)
 
-        return str(result.created)
+        return (str(result.created), img_data)
 
-    def generate_image_edit(case_id, client) -> str:
-        """TI2I: Text + Image ? Image edit."""
+    def generate_image_edit(case_id, client) -> tuple[str, bytes]:
+        """TI2I: Text + Image -> Image edit."""
         if not sampling_params.prompt or not sampling_params.image_path:
-            pytest.skip(f"{id}: no edit config")
+            pytest.skip(f"{case_id}: no edit config")
 
         image_paths = sampling_params.image_path
 
@@ -605,20 +627,25 @@ def get_generate_fn(
             else:
                 new_image_paths.append(Path(image_path))
                 if not image_path.exists():
-                    pytest.skip(f"{id}: file missing: {image_path}")
+                    pytest.skip(f"{case_id}: file missing: {image_path}")
 
         image_paths = new_image_paths
 
         images = [open(image_path, "rb") for image_path in image_paths]
         try:
-            response = client.images.with_raw_response.edit(
-                model=model_path,
-                image=images,
-                prompt=sampling_params.prompt,
-                n=1,
-                size=sampling_params.output_size,
-                response_format="b64_json",
-            )
+            edit_kwargs: dict[str, Any] = {
+                "model": model_path,
+                "image": images,
+                "prompt": sampling_params.prompt,
+                "n": 1,
+                "size": sampling_params.output_size,
+                "response_format": "b64_json",
+            }
+            # Use extra_body for sglang-specific parameters (seed is not in OpenAI SDK)
+            if seed is not None:
+                edit_kwargs["extra_body"] = {"seed": seed}
+
+            response = client.images.with_raw_response.edit(**edit_kwargs)
         finally:
             for img in images:
                 img.close()
@@ -641,12 +668,12 @@ def get_generate_fn(
         )
         os.remove(tmp_path)
 
-        return rid
+        return (rid, img_data)
 
-    def generate_video(case_id, client) -> str:
-        """T2V: Text ? Video."""
+    def generate_video(case_id, client) -> tuple[str, bytes]:
+        """T2V: Text -> Video."""
         if not sampling_params.prompt:
-            pytest.skip(f"{id}: no text prompt configured")
+            pytest.skip(f"{case_id}: no text prompt configured")
 
         return _create_and_download_video(
             client,
@@ -657,17 +684,17 @@ def get_generate_fn(
             seconds=video_seconds,
         )
 
-    def generate_image_to_video(case_id, client) -> str:
-        """I2V: Image ? Video (optional prompt)."""
+    def generate_image_to_video(case_id, client) -> tuple[str, bytes]:
+        """I2V: Image -> Video (optional prompt)."""
         if not sampling_params.image_path:
-            pytest.skip(f"{id}: no input image configured")
+            pytest.skip(f"{case_id}: no input image configured")
 
         if is_image_url(sampling_params.image_path):
             image_path = download_image_from_url(str(sampling_params.image_path))
         else:
             image_path = Path(sampling_params.image_path)
             if not image_path.exists():
-                pytest.skip(f"{id}: file missing: {image_path}")
+                pytest.skip(f"{case_id}: file missing: {image_path}")
 
         with image_path.open("rb") as fh:
             return _create_and_download_video(
@@ -680,17 +707,17 @@ def get_generate_fn(
                 input_reference=fh,
             )
 
-    def generate_text_image_to_video(case_id, client) -> str:
-        """TI2V: Text + Image ? Video."""
+    def generate_text_image_to_video(case_id, client) -> tuple[str, bytes]:
+        """TI2V: Text + Image -> Video."""
         if not sampling_params.prompt or not sampling_params.image_path:
-            pytest.skip(f"{id}: no edit config")
+            pytest.skip(f"{case_id}: no edit config")
 
         if is_image_url(sampling_params.image_path):
             image_path = download_image_from_url(str(sampling_params.image_path))
         else:
             image_path = Path(sampling_params.image_path)
             if not image_path.exists():
-                pytest.skip(f"{id}: file missing: {image_path}")
+                pytest.skip(f"{case_id}: file missing: {image_path}")
 
         with image_path.open("rb") as fh:
             return _create_and_download_video(
-- 
2.52.0

